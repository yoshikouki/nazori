---
description: このルールは、プロジェクトの中核機能である描画キャンバスに関連するファイルに適用されます。
globs: src/features/drawing-canvas/**/*.{ts,tsx}
alwaysApply: false
---
# 描画キャンバスルール

## 参照ファイル

```reference
@file src/features/drawing-canvas/index.tsx
@file src/features/drawing-canvas/line-style.ts
```

## Canvas API の実装

- HTML5 Canvas APIの適切な使用方法に従う
- `getContext("2d")`を使用して描画コンテキストを取得する
- 線の描画には`beginPath()`, `moveTo()`, `quadraticCurveTo()`, `stroke()`などのメソッドを使用する
- パフォーマンスを考慮し、不必要なキャンバスの再描画を避ける
- キャンバスのリサイズ処理では画像データの退行を防ぐ

## ポインターイベント処理

- マウス、タッチ、ペン入力を統一的に処理するためにPointer Eventsを使用する
- イベントリスナーの登録/削除は`useEffect`内で適切に行う
- `e.preventDefault()`を適切に使用して、ブラウザのデフォルト動作を防止する
- `e.pointerType`を確認して、入力デバイスの種類に応じた処理を行う

## 描画スタイリング

- 線のスタイル（色、太さなど）は一元管理し、適切な型定義を行う
- ユーザーに提供する線の色や太さの選択肢は、使いやすさと見やすさを考慮する
- 色の名前は日本語で、わかりやすく簡潔な表現を使用する（例：「くろ」「あか」）
- 線の太さの名前も同様に日本語で簡潔に表現する（例：「ほそい」「ふとい」）

## 画像保存機能

- 保存した画像の品質を確保するため、適切な解像度とフォーマットを使用する
- ファイル名には日付やタイムスタンプを含める
- 保存処理は非同期で行い、UIブロッキングを避ける
- 保存成功/失敗時のユーザーフィードバックを考慮する

## アクセシビリティ

- キャンバス操作のためのキーボードショートカットを提供する
- 色選択UIには適切なARIAラベルを付ける
- 十分なコントラスト比を確保する
- スクリーンリーダーでも操作可能な代替手段を考慮する 